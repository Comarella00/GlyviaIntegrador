<app-header></app-header>

<div class="header">
  <h2>Relatórios</h2>
</div>

<div class="container">
  <!-- Card de seleção -->
  <div class="card selecaoCard">
    <div class="headerCard">
      <h2>Filtros</h2>
    </div>
    <div class="conteudo">
      <div class="campo">
        <label>Tipo de Dado:</label>
        <select [(ngModel)]="tipoDado">
          <option>Glicemia</option>
          <option>Calorias</option>
          <option>Carboidratos</option>
        </select>
      </div>

      <div class="campo">
        <label>Período:</label>
        <div class="datas">
          <div>
            <label>De:</label>
            <input type="date" [(ngModel)]="dataInicio">
          </div>
          <div>
            <label>Até:</label>
            <input type="date" [(ngModel)]="dataFim">
          </div>
        </div>
      </div>

      <div class="botaoContainer">
        <button class="btnBuscar" (click)="buscar()">Buscar</button>
      </div>
    </div>
  </div>

  <!-- Card de resultados -->
  <div class="card resultadoCard">
    <div class="headerCard">
      <h2>Resultados</h2>
    </div>
    <div class="conteudo">

      <!-- Estado inicial -->
      <p *ngIf="!relatorio || relatorio.length === 0 && !carregando" style="text-align:center; margin-top:50px;">
        Informe os dados e clique em <b>Buscar</b>!
      </p>

      <!-- Loading -->
      <p *ngIf="carregando" style="text-align:center; margin-top:50px;">
        Carregando...
      </p>

      <!-- Relatório -->
      <div *ngIf="!carregando && relatorio && relatorio.length > 0">
        <table class="tabela-relatorio">
          <thead>
          <tr>
            <th>Data</th>
            <th>Hora</th>
            <th *ngIf="tipoDado === 'Glicemia'">Glicemia (mg/dL)</th>
            <th *ngIf="tipoDado === 'Calorias'">Calorias (kcal)</th>
            <th *ngIf="tipoDado === 'Carboidratos'">Carboidratos (g)</th>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let item of relatorio">
            <td>{{ item.dataRefeicao || item.dataGlicemia | date: 'dd/MM/yyyy' }}</td>
            <td>{{ item.horaRefeicao || item.horaGlicemia }}</td>
            <td *ngIf="tipoDado === 'Glicemia'">{{ item.valorGlicemia }}</td>
            <td *ngIf="tipoDado === 'Calorias'">{{ item.calorias }}</td>
            <td *ngIf="tipoDado === 'Carboidratos'">{{ item.carboidratos }}</td>
          </tr>
          </tbody>
        </table>
      </div>

    </div>
  </div>
</div>
